{"version":3,"file":"index.umd.js","sources":["../src/index.tsx"],"sourcesContent":["/* ===============================\r\n * Rodal v2.0.0 https://github.com/chenjiahan/vodal\r\n * =============================== */\r\n\r\nimport { $, $$, CSSProperties, ObservableMaybe, useEffect, useMemo } from 'voby'\r\nimport { } from 'voby/dist/types/jsx/types'\r\nimport '../dist/output.css'\r\n\r\nconst IN_BROWSER = typeof window !== 'undefined'\r\nconst UA = IN_BROWSER && window.navigator.userAgent.toLowerCase()\r\nconst IS_IE_9 = UA && UA.indexOf('msie 9.0') > 0\r\n\r\nconst Dialog = (props: VodalProps & { animationType?: ObservableMaybe<string> }) => {\r\n    const {\r\n        showCloseButton,\r\n        onClose,\r\n        duration,\r\n        customStyles,\r\n        id,\r\n        animationType,\r\n        children,\r\n        className = 'w-[50%] h-[25%]',\r\n    } = props\r\n\r\n    const animation = useMemo(() =>\r\n        ($$(animationType) === 'enter'\r\n            ? $$(props.enterAnimation)\r\n            : $$(props.leaveAnimation)) || $$(props.animation))\r\n\r\n\r\n    const CloseButton = showCloseButton ? (\r\n        <span\r\n            className=\"absolute cursor-pointer w-4 h-4 right-4 top-4 before:rotate-45 after:-rotate-45\r\n            \r\n            before:absolute before:content-[''] before:h-0.5 before:w-full before:bg-[#999] before:transition-[background] before:duration-[0.2s] before:-mt-px before:rounded-[100%] before:left-0 before:top-2/4 \r\n            after:absolute after:content-[''] after:h-0.5 after:w-full after:bg-[#999] after:transition-[background] after:duration-[0.2s] after:-mt-px after:rounded-[100%] after:left-0 after:top-2/4 \r\n            hover:before:bg-[#333] hover:after:bg-[#333]\r\n            \"\r\n            onClick={onClose}\r\n            onKeyPress={event => {\r\n                if (onClose && event.which === 13) {\r\n                    onClose(event)\r\n                }\r\n            }}\r\n            tabIndex={0}\r\n        />\r\n    ) : null\r\n\r\n    const style = useMemo(() => ({\r\n        animationDuration: $$(duration) + 'ms',\r\n        ...customStyles,\r\n    }))\r\n\r\n    return <div style={style} className={[`absolute z-[101] bg-[#fff] shadow-[0_1px_3px_rgba(0,0,0,0.2)] m-auto p-[15px] rounded-[3px] inset-0 focus:outline-none`, () => `vodal-${$$(animation)}-${$$(animationType)}`, className]} id={id}>\r\n        {children}\r\n        {CloseButton}\r\n    </div>\r\n}\r\n\r\ninterface VodalProps {\r\n    visible?: ObservableMaybe<boolean>\r\n    showMask?: ObservableMaybe<boolean>\r\n    closeOnEsc?: ObservableMaybe<boolean>\r\n    closeMaskOnClick?: ObservableMaybe<boolean>\r\n    showCloseButton?: ObservableMaybe<boolean>\r\n    animation?: ObservableMaybe<string>\r\n    enterAnimation?: ObservableMaybe<string>\r\n    leaveAnimation?: ObservableMaybe<string>\r\n    duration?: ObservableMaybe<number>\r\n    className?: JSX.Class\r\n    customStyles?: ObservableMaybe<CSSProperties>\r\n    customMaskStyles?: ObservableMaybe<CSSProperties>\r\n    onClose?: (event?) => void\r\n    onAnimationEnd?: () => void\r\n    id?: string,\r\n    children?: JSX.Children\r\n}\r\n\r\nexport const Vodal = (props: VodalProps) => {\r\n    const newProps = {\r\n        ...{\r\n            visible: false, showMask: true, closeOnEsc: false, closeMaskOnClick: true, showCloseButton: true, animation: 'zoom',\r\n            enterAnimation: '', leaveAnimation: '', duration: 300, customStyles: {}, customMaskStyles: {},\r\n        } as VodalProps\r\n        , ...props\r\n    }\r\n\r\n    const {\r\n        visible, showMask, closeOnEsc, closeMaskOnClick,\r\n        duration, customMaskStyles,\r\n        onClose, onAnimationEnd,\r\n    } = newProps\r\n\r\n    const isShow = $(false)\r\n    const animationType = $('leave')\r\n    const elRef = $<HTMLDivElement>(null)\r\n\r\n    const enter = () => {\r\n        isShow(true)\r\n        animationType('enter')\r\n    }\r\n\r\n    const leave = () => {\r\n        isShow(false)\r\n        animationType(IS_IE_9 ? 'leave' : 'leave')\r\n    }\r\n\r\n    useEffect(() => {\r\n        if ($$(visible)) {\r\n            enter()\r\n        } else if (!$$(visible) && $$(isShow)) {\r\n            leave()\r\n        }\r\n    })\r\n\r\n    const onKeyUp = event => {\r\n        if ($$(closeOnEsc) && event.keyCode === 27) {\r\n            onClose?.(event)\r\n        }\r\n    }\r\n\r\n    const animationEnd = event => {\r\n        if ($$(animationType) === 'leave') {\r\n            isShow(false)\r\n        } else if ($$(closeOnEsc)) {\r\n            $$(elRef)?.focus()\r\n        }\r\n\r\n        if (event.target === $$(elRef) && onAnimationEnd) {\r\n            onAnimationEnd()\r\n        }\r\n    }\r\n\r\n    const Mask = $$(showMask) ? (\r\n        <div\r\n            className=\"w-full h-full z-[100] absolute bg-[rgba(0,0,0,0.3)] left-0 top-0\"\r\n            style={customMaskStyles}\r\n            onClick={(e) => $$(closeMaskOnClick) ? onClose?.(e) : {}}\r\n        />\r\n    ) : null\r\n\r\n    const style = useMemo(() => ({\r\n        display: $$(isShow) ? '' : 'none',\r\n        animationDuration: $$(duration) + 'ms',\r\n    }))\r\n\r\n    return <div\r\n        style={style}\r\n        className={['w-full h-full z-[100] left-0 top-0 fixed', () => `vodal-fade-${animationType}`]}\r\n        onAnimationEnd={animationEnd}\r\n        tabIndex={-1}\r\n        ref={elRef}\r\n        onKeyUp={onKeyUp}\r\n    >\r\n        {Mask}\r\n        <Dialog\r\n            {...{\r\n                animationType,\r\n                ...newProps\r\n            }}\r\n        />\r\n    </div>\r\n}\r\n"],"names":["useMemo","$$","jsx","$","useEffect","jsxs"],"mappings":"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"}